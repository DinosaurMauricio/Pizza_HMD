version: "3.1"
stories:

##################### Pizza Ordering
- story: greeting
  steps:
  - intent: welcome_greet
  - action: utter_welcome_greet
  - intent: init_request
  - action: utter_init_request

- story: order pizza
  steps:
  - intent: pizza_order_start
  - action: pizza_order_form
  - active_loop: pizza_order_form
  - slot_was_set:
    - requested_slot: pizza_type
  - slot_was_set:
    - requested_slot: pizza_amount
  - slot_was_set:
    - requested_slot: pizza_size
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_summarize_pizza_order

- story: complete pizza order
  steps:
  - intent: pizza_order_start
    entities:
    - pizza_amount: two
    - pizza_type: Funghi
    - pizza_size: 10"
  - slot_was_set:
    - pizza_amount: two
  - slot_was_set:
    - pizza_size: 10"
  - slot_was_set:
    - pizza_type: Funghi
  - action: pizza_order_form
  - active_loop: pizza_order_form
  - slot_was_set:
    - pizza_amount: two
  - slot_was_set:
    - pizza_type: Funghi
  - slot_was_set:
    - pizza_size: 10''
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_summarize_pizza_order
  - intent: pizza_order_confirm_positive
  - action: action_pizza_order_add
  - slot_was_set:
    - pizza_type: null
  - slot_was_set:
    - pizza_size: null
  - slot_was_set:
    - pizza_amount: null
  - slot_was_set:
    - pizzas_complete_order:
      - size: 10''
        type: Funghi
        amount: two
  - action: utter_pizza_order_confirm_positive
  - intent: response_negative
  - action: action_total_order
  - action: utter_summarize_complete_order
  

- story: change the pizza order
  steps:
  - action: utter_summarize_pizza_order
  - intent: pizza_order_confirm_negative
  - action: utter_pizza_order_confirm_negative
  - intent: pizza_order_change
    entities:
      - pizza_type: "Pepperoni"
      - pizza_size: "Small"
      - pizza_amount: "Three"
  - action: action_change_order
  - action: utter_pizza_order_change
  - intent: pizza_order_confirm_positive
  - action: action_pizza_order_add
  - action: utter_pizza_order_confirm_positive

- story:  accept pizza and utter the complete order
  steps:
  - action: utter_summarize_pizza_order
  - intent: pizza_order_confirm_positive
  - action: action_pizza_order_add
  - action: utter_pizza_order_confirm_positive
  - intent: response_negative
  - action: action_total_order
  - action: utter_summarize_complete_order
  - intent: complete_order_confirm
  - action: utter_name_phone

- story: get details customer details
  steps:
  - action: action_total_order
  - action: utter_summarize_complete_order
  - intent: complete_order_confirm
  - action: utter_name_phone

- story: order delivery
  steps:
  - action: utter_name_phone
  - intent: order_delivery
  - action: utter_delivery_address


- story: give costumer details
  steps:
  - intent: response_name_phone
  - action: costumer_details_form
  - active_loop: costumer_details_form
  - slot_was_set:
    - requested_slot: client_name
  - slot_was_set:
    - requested_slot: phone_number
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - action: utter_order_takeout


##################### Side Dishes

- story: order add side dish
  steps:
  - intent: order_side_dish
    entities:
    - side_dish: "Caprese Salad"
  - action: action_add_side_dish
  - action: utter_side_dishes_order

- story: question on side dish menu + add side dish
  steps:
  - intent: ask_for_side_dish_options
  - action: utter_ask_for_side_dish_options
  - intent: order_side_dish
    entities:
    - side_dish: "French fries"
  - action: action_add_side_dish
  - action: utter_side_dishes_order

- story: repeat side dish menu + add side
  steps:
  - intent: ask_for_side_dish_options
  - action: utter_ask_for_side_dish_options
  - intent: repeat_side_dish_menu
  - action: utter_repeat_side_dish_menu
  - intent: order_side_dish
    entities:
    - side_dish: "Chicken wings"
  - action: action_add_side_dish
  - action: utter_side_dishes_order

- story: remove side dish from order
  steps:
  - intent: remove_side_dish
    entities:
    - side_dish: "French fries"
  - action: action_remove_side_dish
  - action: utter_side_dishes_order

- story: add and remove side dish from order
  steps:
  - intent: ask_for_side_dish_options
  - action: utter_ask_for_side_dish_options
  - intent: repeat_side_dish_menu
  - action: utter_repeat_side_dish_menu
  - intent: order_side_dish
    entities:
    - side_dish: "Chicken wings"
  - action: action_add_side_dish
  - action: utter_side_dishes_order
  - intent: remove_side_dish
    entities:
    - side_dish: "Chicken wings"
  - action: action_remove_side_dish
  - action: utter_side_dishes_order

- story: cancel side dish + repeat side dish menu
  steps:
  - intent: ask_for_side_dish_options
  - action: utter_ask_for_side_dish_options
  - intent: repeat_side_dish_menu
  - action: utter_repeat_side_dish_menu
  - intent: cancel_side_dish
  - action: action_remove_all_side_dishes
  - action: utter_cancel_side_dish

- story: cancel side dish order
  steps:
  - intent: ask_for_side_dish_options
  - action: utter_ask_for_side_dish_options
  - intent: cancel_side_dish
  - action: action_remove_all_side_dishes
  - action: utter_cancel_side_dish

##################### Promotions

- story: ask for promotions
  steps:
  - intent: promotions_faq
  - action: utter_promotions_faq
# TODO: could be extended so that it can reject and ask for other promotions

# ex. "I want to order a promotion" or "I'm vegetarian and want a promotion"
- story: vague recommend promotion veggie feast 
  steps:
  - intent: order_promotion_vague
    entities:
    - is_vegetarian: 'True'
  - slot_was_set:
    - is_vegetarian: 'True'
  - action: action_validate_promotion_posibility
  - action: action_recommend_promotion
  - intent: promotion_order_accept_recommended
  - slot_was_set:
    - promotion_type: Veggie Feast
  - action: utter_veggie_feast_order_start

# ex. "I want to order a promotion" or "I need a promotion for a party"
- story: vague recommend promotion duo party
  steps:
  - intent: order_promotion_vague
    entities:
    - is_reunion: 'True'
  - slot_was_set:
    - is_reunion: 'True'
  - action: action_validate_promotion_posibility
  - action: action_recommend_promotion
  - intent: promotion_order_accept_recommended
  - slot_was_set:
    - promotion_type: Duo Party
  - action: utter_duo_party_order_start

- story: max promotion reached
  steps:
  - action: action_validate_promotion_posibility
  - slot_was_set:
    - is_max_promotion_reached: true
  - action: utter_promotion_limit_reached

- story: order promotion vague - duo party
  steps:
  - intent: order_promotion_vague
  - action: action_validate_promotion_posibility
  - slot_was_set:
    - is_max_promotion_reached: false
  - action: action_recommend_promotion
  - intent: promotion_order_accept_recommended
    entities:
      - promotion_type: "Duo Party"
  - slot_was_set:
      - promotion_type: "Duo Party"
  - action: action_activate_recommend_promotion_form

- story: order promotion vague - veggie feast
  steps:
  - intent: order_promotion_vague
  - action: action_validate_promotion_posibility
  - slot_was_set:
    - is_max_promotion_reached: false
  - action: action_recommend_promotion
  - intent: promotion_order_accept_recommended
    entities:
      - promotion_type: "Veggie Feast"
  - slot_was_set:
      - promotion_type: "Veggie Feast"
  - action: action_activate_recommend_promotion_form

- story: duo party promotion
  steps:
  - action: utter_duo_party_order_start
  - intent: pizza_duo_promotion_order
  - action: action_recommend_items
  - action: duo_party_form
  - active_loop: duo_party_form
  - slot_was_set:
    - requested_slot: first_pizza_promotion
  - slot_was_set:
    - requested_slot: second_pizza_promotion
  - slot_was_set:
    - requested_slot: first_side_dish_promotion
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - checkpoint: end_promotion_vague

- story: veggie feast promotion
  steps:
  - action: utter_veggie_feast_order_start
  - intent: pizza_veggie_promotion_order
  - action: action_recommend_items
  - action: veggie_feast_form
  - active_loop: veggie_feast_form
  - slot_was_set:
    - requested_slot: first_side_dish_promotion
  - slot_was_set:
    - requested_slot: second_side_dish_promotion
  - slot_was_set:
    - requested_slot: null
  - active_loop: null
  - checkpoint: end_promotion_vague

- story: submit promotion form
  steps:
  - checkpoint: end_promotion_vague
  - action: action_promotion_total_order
  - action: utter_summarize_promotion_order
  - intent: submit_promotion_confirm_positive
  - action: action_promotion_add
  - action: utter_recommend_other_items
  - action: action_promotion_reset
  - intent: response_negative
  - action: action_total_order
  - action: utter_summarize_complete_order
  - intent: complete_order_confirm
  - action: utter_name_phone

- story: cancel promotion after chosen - duo
  steps:
  - action: utter_duo_party_order_start
  - intent: stop_promotion_order
  - action: utter_ask_continue_with_promotion
  - intent: confirm_stop_promotion_order
  - action: action_promotion_reset
  - action: utter_promotion_canceled

- story: cancel promotion after chosen - veggie
  steps:
  - action: utter_veggie_feast_order_start
  - intent: stop_promotion_order
  - action: utter_ask_continue_with_promotion
  - intent: confirm_stop_promotion_order
  - action: action_promotion_reset
  - action: utter_promotion_canceled

- story: User doesn't want the promotion anymore - Duo party
  steps:
  - intent: pizza_duo_promotion_order
  - action: action_recommend_items
  - action: duo_party_form
  - active_loop: duo_party_form
  - checkpoint: deactivate_current_form

- story: User doesn't want the promotion anymore - Veggie Feast
  steps:
  - intent: pizza_veggie_promotion_order
  - action: action_recommend_items
  - action: veggie_feast_form
  - active_loop: veggie_feast_form
  - checkpoint: deactivate_current_form

- story: User wants to cancel promotion
  steps:
  - checkpoint: deactivate_current_form
  - intent: stop_promotion_order
  - action: utter_ask_continue_with_promotion
  - intent: confirm_stop_promotion_order
  - action: action_promotion_reset
  - action: action_deactivate_loop
  - active_loop: null
  - action: action_promotion_reset
  - action: utter_promotion_canceled


# TODO: Check behavior when user wants to change promotion in Veggie such that it tries to modify the pizza
# or in duo party such that it tries to modify the second side dish
- story: modified promotion + confirm
  steps:
  - action: utter_summarize_promotion_order
  - intent: submit_promotion_confirm_negative
  - action: utter_promotion_change
  - intent: change_item_promotion_specific
    entities:
    - first_pizza_promotion: "Margherita"
    - second_pizza_promotion: "Hawaii"
    - first_side_dish_promotion: "French Fries"
    - second_side_dish_promotion: "Caprese Salad"
  - action: action_change_promotion_item
  - action: action_promotion_total_order
  - action: utter_promotion_change_summarize
  - intent: submit_promotion_confirm_positive
  - action: action_promotion_add
  - action: utter_recommend_other_items
  - action: action_promotion_reset

